function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],l=!0,o=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);l=!0);}catch(e){o=!0,a=e}finally{try{l||null==n.return||n.return()}finally{if(o)throw a}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}define("pizzabuildermodules/dpz.pizzaBuilderUpsells",["dpz.config","dpz.template","marketconfig/dpz.lang.general","marketconfig/dpz.lang.builders","pizzabuildermodules/dpz.pizzaBuilderConstants"],function(c,e,l,o,t){var n=e.contextFixed.market_assets_ctx,s=e.translate,r=t.NORMAL,a=t.WHOLE,i={event_name:"Yes, Cheese it Up!",event_action:"Accepted",event_category:"Pizza Builder",event_label:"Cheese Upsell",modal_name:"Cheese Upsell",segment_event_name:"Promotion Clicked",segment_promotion_id:"step-level-upsell",segment_creative:"Pizza Builder Step Level Upsell",segment_name:"Extra Cheese Upsell",segment_position:"pizza-builder-step"},u={event_name:"No Thanks",event_action:"Declined",event_category:"Pizza Builder",event_label:"Cheese Upsell",modal_name:"Cheese Upsell"};return{premiumCheese:{templateTokens:function(){return{imgPath:"".concat(n,"/images/builder/pizza/premiumCheeseUpsell.jpg"),imgAlt:"",translationString:"builders.add_premium_cheese",noText:s("general.no_thanks",null,l),yesText:s("builders.yes_cheese_it_up",null,o)}},newVariantCode:"",upsellData:{utagAccept:_objectSpread(_objectSpread({},i),{},{event_name:"Yes, With Premium Cheese!",event_label:"Premium Cheese Upsell",modal_name:"Premium Cheese Upsell",segment_name:"Premium Cheese Upsell"}),utagDecline:_objectSpread(_objectSpread({},u),{},{event_label:"Premium Cheese Upsell",modal_name:"Premium Cheese Upsell"})},updateVariant:function(e){var t=e.currentVariant,n=e.commonBuilder,r=c.getMarketProperty("pizzaBuilder").premiumCheeseCode;t.Toppings[r]={"1/1":"1"},n.functions.updateDescription()},eligible:function(e){var t,n=e.commonBuilder,r=e.currentVariant,a=n.catalog.data.Toppings.Pizza,i=n.cheeseCodeArray,l=void 0===i?[]:i,o=c.getMarketProperty("pizzaBuilder").premiumCheeseCode,s=a[o],u=Object.entries(r.Toppings).some(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return l.includes(n)&&Object.values(r).some(function(e){return 1<+e})}),p=0<+(null===(t=r.Toppings[o])||void 0===t?void 0:t["1/1"]);return s&&!u&&!p}},specialtyTopping:{eligible:function(e){return e.commonBuilder.functions.getIsEligibleForSpecialtyPizzaUpsell()},templateTokens:function(e){var t=e.commonBuilder,n=e.currentVariant,r=jsDPZ.app.catalog.getCatalog().getVariant(n.Code).data.ProductCode,a=jsDPZ.app.catalog.getCatalog().getProduct(r).data.Name,i=t.functions.getUpsellToppingForVariant(n.Code).upsellToppingName;return{productName:a,supplementaryTranslationString:"builders.additional_charges_apply",translationString:"builders.do_you_want_to_add",translationTokens:{upsellToppingName:i},upsellToppingName:i,noText:s("general.no_thanks",null,l),yesText:s("builders.yes_add_topping",{upsellToppingName:i},o)}},updateVariant:function(e){var t=e.commonBuilder,n=e.currentVariant,r=t.functions.getUpsellToppingForVariant(n.Code).upsellToppingCode;t.functions.setToppingUpsell(r,a),t.functions.updateDescription()},upsellData:{utagAccept:{event_name:"Yes, Add Topping",event_action:"Accepted",event_category:"Pizza Builder",event_label:"Specialty Topping Upsell",modal_name:"Specialty Topping Upsell"},utagDecline:{event_name:"No Thanks",event_action:"Declined",event_category:"Pizza Builder",event_label:"Specialty Topping Upsell",modal_name:"Specialty Topping Upsell"}}},stuffedCrust:{templateTokens:function(){return{imgPath:"".concat(n,"/images/builder/pizza/crustUpsell.jpg"),imgAlt:"",translationString:"builders.add_stuffed_crust",noText:s("general.no_thanks",null,l),yesText:s("builders.yes_with_stuffed_crust",null,o)}},newVariantCode:"",upsellData:{utagAccept:{event_name:"Yes, With Stuffed Crust!",event_action:"Accepted",event_category:"Pizza Builder",event_label:"Stuffed Crust Upsell",modal_name:"Stuffed Crust Upsell"},utagDecline:_objectSpread({},u)},updateVariant:function(e){var t=e.currentVariant,n=e.commonBuilder;t.Code=this.newVariantCode,n.functions.updateDescription()},eligible:function(e){var t=e.commonBuilder,n=e.currentVariant,r=t.catalog,a=r.getVariant(n.Code).data.ProductCode,i=r.getProduct(a).data,l=r.getVariant(n.Code).data,o=c.getMarketProperty("pizzaBuilder").crusts.HANDTOSS,s=o.crustUpsellFlavorCode.STUFFED;return this.newVariantCode=i.Variants.find(function(e){return r.getVariant(e).data.SizeCode===l.SizeCode&&r.getVariant(e).data.FlavorCode===s&&o&&t.crustType===o.flavorCode}),this.newVariantCode&&l.FlavorCode===o.flavorCode}},cheese:{templateTokens:function(){return{imgPath:"".concat(n,"/images/builder/pizza/cheeseUpsell.jpg"),imgAlt:"",translationString:"builders.like_cheese_cheese_it_up",noText:s("general.no_thanks",null,l),yesText:s("builders.yes_cheese_it_up",null,o)}},upsellData:{utagAccept:_objectSpread({},i),utagDecline:_objectSpread({},u)},updateVariant:function(e){var t=e.commonBuilder;t.functions.setToppingUpsell(),t.functions.updateDescription()},eligible:function(e){var t=e.commonBuilder,n=e.currentVariant;return t.cheeseUpsellCode&&n.Toppings[t.cheeseUpsellCode][a]&&n.Toppings[t.cheeseUpsellCode][a]===r}}}});