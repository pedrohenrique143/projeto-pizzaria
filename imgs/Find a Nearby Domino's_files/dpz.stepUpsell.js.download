var _excluded=["items"];function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _objectWithoutProperties(e,r){if(null==e)return{};var t,n,o=_objectWithoutPropertiesLoose(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],0<=r.indexOf(t)||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function _objectWithoutPropertiesLoose(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],0<=r.indexOf(t)||(o[t]=e[t]);return o}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(n=t.next()).done)&&(a.push(n.value),!r||a.length!==r);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(s)throw o}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}define("dpz.stepUpsell",["dpz.config","dpz.template"],function(e,r){function s(e){var r=p.getProduct(e),t={};if(!jsDPZ.util.empty(r)){var n=r.data,o=n.Name,a=n.Variants,i=dpz.market.directory,s=r.getImageURL({size:r.imageSizes.THUMBNAIL,baseURL:"".concat(i,"/images/img/products")}),u=_slicedToArray(a,1)[0],c=p.data.Variants[u].Price,l=d("numbers");t={name:o,productCode:e,productImagePath:s,productPrice:killConfig.isMarketEnabled("priceBuilder")?f(c,l):""}}return t}var p,d=e.getMarketProperty,f=r.formatMoney,u={SIDE:"sides",DRINKS:"drinks",FLAVOR:"extras",DESSERT:"desserts"};function c(){return new Promise(function(e){var r=$.extend(!0,{},d("upsells")).stepUpsells;function t(e){return e&&0<Object.keys(e).length}var n=jsDPZ.app.order.getOrder().data.Details.Variants.map(function(e){return e.Code});e(Object.values(r).sort(function(e,r){return e.step-r.step}).filter(function(e){return!function(e,r){var t=e.type,n=void 0===t?"":t,o=e.productTypes,a=void 0===o?[]:o,i=!1;return $.each(r,function(e,r){var t=p.getProduct(p.getVariant(r).data.ProductCode).data.ProductType;return a.includes(t)?!(i=!0):"drinks"===n&&"Drinks"===t?!(i=!0):"sides"!==n||"Wings"!==t&&"Bread"!==t&&"GSalad"!==t?"desserts"===n&&"Dessert"===t?!(i=!0):"upsell"===n&&"Upsell"===t?!(i=!0):"chicken"!==n||"Wings"!==t||!(i=!0):!(i=!0)}),i}(e,n)}).map(function(e){var r=e.items;return _objectSpread(_objectSpread({},_objectWithoutProperties(e,_excluded)),{},{items:r.map(s).filter(t)})}).filter(function(e){return e.items.length}))})}return{getStepUpsellForOrder:function(e){var r=e.order,t=e.options,n=e.ecom72315;p=jsDPZ.app.catalog.getCatalog();var o=d("upsells").stepUpsells.stepTypes;if(jsDPZ.util.empty(o))return c();var a=o.map(function(e){return _slicedToArray(Object.keys(e),1)[0]}),i=o.reduce(function(e,r){var t=_slicedToArray(_slicedToArray(Object.entries(r),1)[0],2),n=t[0],o=t[1];return e[n]=o,e},{});return null!=n&&n.isEcom72315ExperienceB||null!=n&&n.isEcom72315ExperienceD?Promise.resolve([]):jsDPZ.ajax.getStepUpsellForOrder(_objectSpread({data:{order:r,stepTypes:a}},t)).then(function(e){return e.steps.map(function(e){var r=e.stepType;return{items:e.upsellProducts.slice(0,i[r]).map(function(e){return e.code}).map(s).filter(Boolean),type:u[r]}})}).catch(function(){return[]})}}});