define("dpz.deliverToMeMap",["simplr","dpz.template","marketconfig/dpz.lang.deliverToMe","dpz.geolocation"],function(e,o,t,n){var p=n.calculateDistance,i=urlConfig.assets,r={x:8,y:24.2},a={anchor:r,icon:"".concat(i,"/images/hotspots/map-selected-pin.svg"),disabledIcon:"".concat(i,"/images/hotspots/disabled-map-pin.svg")},s={anchor:r,icon:"".concat(i,"/images/hotspots/map-selected-pin.svg"),disabledIcon:"".concat(i,"/images/hotspots/disabled-map-selected-pin.svg")},d=o.translate("deliverToMe.selected",null,t);return{activePinValues:s,defaultPinValues:a,dropHotspotPin:function(e,o,t,n,i,r){var a=Number.POSITIVE_INFINITY,s=i.deliverySpot,d=i.deliveryStore,c=i.placeId,l=p(s,n),g=o(e,s,d),u=l||Number.POSITIVE_INFINITY;t(c,g),e.dropPin(g),u<a&&(a=u),e.boundOnCoordinates([g.coordinates,n,r]),g.onClick({},!0)},failWithoutGeoPerms:function(e,o){"string"==typeof e?o.func.overlayToggle(!0,"codeOverlay",{},{code:e}):e.message&&"User denied Geolocation"===e.message||"User denied geolocation prompt"===e.message||"This site does not have permission to use the Geolocation API."===e.message||"This site doesnâ€™t have permission to ask for your location."===e.message?o.func.overlayToggle(!0,"deliverToMeLocationErrorOverlay",{},{return:!0}):o.func.powerCommunicationError()},formatDistance:function(e){return e?parseFloat(e).toFixed(1):null},selectedText:d,setNewLocationMarker:function(e){var o=e.getMarker("customLocation");if(o)$.extend(!0,o,{coordinates:e.getCenter()}),e.updatePin(o);else{var t=e.createPin("customLocation",e.getCenter(),{draggable:!1});e.dropPin(t)}!function(e,o){var t=e.getMarker(o).marker,n=e.map;e.addListener(t,"dragend",function(){n.setCenter(n.getPosition())}),e.addListener(n,"drag",function(){t.setPosition(n.getCenter())}),e.addListener(n,"dragend",function(){t.setPosition(n.getCenter())}),e.addListener(n,"idle",function(){t.setPosition(n.getCenter())})}(e,"customLocation")},stopCenteringMarkerOnMap:function(e,o){var t=e.getMarker(o).marker,n=e.map;e.removeListener(t,"dragend"),e.removeListener(n,"drag"),e.removeListener(n,"dragend"),e.removeListener(n,"idle")},userPinValues:{icon:"userLocation"}}});