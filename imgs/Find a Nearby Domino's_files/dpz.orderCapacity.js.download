function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}define("dpz.orderCapacity",["simplr","dpz.config","dpz.template"],function(b,e,j){function d(e){return"dpz_future_order_capacity_black_list_".concat((0<arguments.length&&void 0!==e?e:"").replace("-","").toLowerCase())}function t(){return y("order").isFutureOrderCapacityEnabled}function s(){var e=function(e){return e.data.Details.ServiceMethod||""}(jsDPZ.app.order.getOrder());return t()&&jsDPZ.dataConversion.JSONStringToObject(site.storage.load(d(e)))||[]}function r(){function e(e){var t=0<arguments.length&&void 0!==e?e:[];site.storage.save(d(o),jsDPZ.dataConversion.JSONObjectToString(t))}var t=jsDPZ.app.order.getOrder(),r=jsDPZ.app.store.getStore(),a=s(),o=t.data.Details.ServiceMethod,n=r.data,i=n.BusinessDate,c=n.StoreID;return jsDPZ.ajax.getFutureOrderCapacityBlackList({storeId:c,startDate:i,serviceMethod:o}).then(e).catch(function(){return e(a)})}var y=e.getMarketProperty;return{isFutureOrderCapacityEnabled:t,getFutureOrderCapacityBlacklist:s,updateFutureOrderCapacityBlacklist:r,showFutureOrderLimitModal:function(e){var m=e.validateOrderOnUpdate,v=e.redirectToOrderOnCancel;r().then(function(){require(["order.components","marketconfig/dpz.lang.locations","marketconfig/dpz.lang.overlays"],function(e,t,r){function a(){if(v)return jsDPZ.app.customer.getCustomer().data.Session.forceFutureDateSelection=!0,site.sessionTools.save().then(function(){window.location="".concat(urlConfig.localRoot,"/pages/order/")});b.controller.mRouteAndExecute(site.func.buildURL({url:"#!/order/time/view",parameters:{code:"eOrderDateTimeInvalid"}}))}var o=e.FutureOrderLimitModal,n=e.TranslateContext,i=jsDPZ.app.order.getOrder().data.Details.OrderDateTime,c=y("date").format,d=c.DATE_TIME,s=c.SERVER_DATE_POWER,u=c.SERVER_DATE_TIME_POWER,l=c.SERVER_TIME_POWER,p=c.TIME,f=site.catalogTools.getNextOrderableDateTime(i);if(f){var O=dayjs(i,u),g=dayjs(f,u);preact.render(preact.h(n.Provider,{value:j.getTranslateContextValue(_objectSpread(_objectSpread({},t),r))},preact.h(o,{site:site,dpzTemplate:j,nextAvailableTimeSlot:g.format(g.isAfter(O,"day")?d:p),chooseNextAvailableSlot:function(){b.controller.mRouteAndExecute(site.func.buildURL({url:"#!/order/time/update",parameters:{date:g.format(s),time:g.format(l),validateOrder:m}}))},chooseDifferentTime:a,serviceMethod:jsDPZ.app.order.getOrder().data.Details.ServiceMethod})),document.querySelector(".js-modalContainer"))}else a()})})}}});