function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}define(function(){var r={},o=[],a=function(){},s=!1;return{setStatusCodes:function(e){o=e},getStatusCodes:function(e){return o[e]||o},setHandlers:function(e){$.extend(!0,r,e)},getHandlers:function(){return r},setErrorHandler:function(e){a=e},getErrorHandler:function(){return a},fetch:function(n){var r=0;if("string"!=typeof n.transactionId)return $.Deferred().reject(new Error("Invalid transaction Id or transaction Id missing"));function o(e,t){n.pollStatus&&(null==e?void 0:e.TransactionStatus)===n.pollStatus?setTimeout(t,n.pollInterval||500):0===(null==e?void 0:e.status)&&"timeout"===e.statusText&&r<(n.maxTimeouts||3)?(r++,t()):a.resolve(e)}var a=$.Deferred();return function t(){n.advancedPayment?n.advancedStatus(n.transactionId,n.paymentDetails).always(function(e){return o(e,t)}):jsDPZ.ajax.globalPaymentStatus(_objectSpread(_objectSpread({},n),{},{url:n.url(n.transactionId,n.versionNext)})).always(function(e){return o(e,t)})}(),a},handle:function(t){var e;try{if(void 0===(e=t.TransactionStatus||t.transactionStatus))throw new Error("TransactionStatus is undefined.");["PENDING","WAITING_CONFIRMATION","WAITING_NOTIFICATION"].includes(e)||site.func.toggleLoading("golopayment",!1)}catch(e){jsDPZ.topic("gpm.transaction_status_error.IOLO-15696").publish({error:e,customData:t}),console.error("transaction status undefined"),console.log(e),console.log(t)}if(~o.indexOf(e)){var n=e.toLowerCase();(~n.indexOf("success")||~n.indexOf("duplicate"))&&jsDPZ.topic("checkout.priceOrder").publish(),killConfig.isMarketEnabled("dcc5923a-931e-49df-bace-5d7c8b1d0db1")&&"WAITING_NOTIFICATION"===e&&!s?(s=!0,require(["shared.components","contexts.components","marketconfig/dpz.lang.forms","marketconfig/dpz.lang.payment"],function(e,t,n,r){var o=e.Modal,a=e.CodeOverlay,s=(0,t.withGNOLOContext)(o);preact.render(preact.h(s,{title:dpz.template.translate("forms.attention",null,n),closeButtonClass:"is-hidden"},preact.h(a,{codeClass:"errorText",message:dpz.template.translate("payment.waiting_notification_message",null,r)})),document.body)})):"WAITING_NOTIFICATION"!==e&&(s=!1,preact.render(null,document.body,document.querySelector(".js-modal"))),r[o.indexOf(e)](t)}else site.func.toggleLoading("golopayment",!1),a(new ReferenceError("Status ".concat(e," has no associated handler.")))}}});