define(function(){var n,i={},o="",r=[],a="",s={};return $.extend(i,{init:function(t){var e;o=null!==(e=t.savedValue)&&void 0!==e?e:"",n=t.dropdown,i.off()},fetch:function(t){t.state&&jsDPZ.ajax.globalStoreSearchTypeAheadCity(t).then(function(t){return i.reset(t)})},set:function(t){return(t=t||o)&&n.children().is('[value="'+t+'"]')&&n.val(t),n.change(),i},empty:function(){return $("option",n).not(":first").remove(),r=[],a="",i},off:function(){return n.attr("disabled","disabled"),i},mapCityRegions:function(t){$.isArray(t)&&t.length&&$.each(t,function(t,e){s[e.name]=e.regionName})},getRegionForCity:function(t){return s[t]},fill:function(t){if($.isPlainObject(t)&&$.isArray(t.Cities)&&t.Cities.length){var e=t.Cities.map(function(t){return{code:t}});r=site.locationTools.getListData(e,"code","code"),a=site.func.buildOptionList({listValues:r}),n&&(n.append(a),$(".js-city").prop("disabled",!1))}return i},reset:function(t){return i.empty().fill(t).set().mapCityRegions(t),i}}),i});